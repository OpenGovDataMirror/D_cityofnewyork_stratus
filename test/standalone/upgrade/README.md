# Stratus Upgrade Test

Runs a simple test for upgrading from one version of Stratus to another. Primarily tests catalog and configuration (de)serialization

## Prerequesites

* Docker
* Docker images for the Stratus versions you want to test.

## Docker images

If you do not already have docker images for each of the Stratus versions you want to test, you will have to build them. To do so, navigate to the `src/stratus-application` and run the following, for each applicable version:

    git checkout $VER
    mvn clean package docker:build
    docker tag gsstratus/stratus:latest gsstratus/stratus:$VER

## Usage

    ./test_upgrade.sh $OLD_VER $NEW_VER

Where:

* `OLD_VER` refers to the Stratus tag you want to test upgrading from

* `NEW_VER` refers to the Stratus tag you want to upgrade to.


## Files:

* `test_upgrade.sh` - the main test script

* `env.sh` - environment variables shared between scripts

* `load_catalog.sh` - uses the rest api to load a basic catalog and configuration.

* `stratus.sh` - Destroys any existing Stratus instance, then starts up a new one with the specified tag and output file.

* `stratus-old.log` - Stratus standard out for the initial version. Generated by init.sh

* `stratus-new.log` - Stratus standard out for the upgraded version. Generated by upgrade.sh

* `config/` - catalog and configuration XML snippets used by `load_catalog.sh`.

